function octtree_root(){var b=Number.MAX_VALUE/2;return new Octtree(-b,b,-b,b,-b,b)}function Octtree(b,c,a,k,e,d,f){this.xMin=b;this.xMax=c;this.yMin=a;this.yMax=k;this.zMin=e;this.zMax=d;this.parent=f;this.xMid=b+(c-b)/2;this.yMid=a+(k-a)/2;this.zMid=e+(d-e)/2;this.is_empty=is_empty;this.has_value=has_value;this.add=add;this.del=del;this.find=find;this.find4=find4;this.update=update}function find(b,c,a){this.find4(b,c,c*c,a)}
function find4(b,c,a,k){for(var e=Array(this),d=void 0,f=0,h=0,g=0,l=0,i=0,j=0;0<e.length;)d=e.shift(),d.is_empty()||(d.has_value()?(f=Math.abs(d.value.x-b.x),h=Math.abs(d.value.y-b.y),g=Math.abs(d.value.z-b.z),f*=f,h*=h,g*=g,f+h+g<=a&&k.push(d)):(f=b.x+c,h=b.x-c,g=b.y+c,l=b.y-c,i=b.z+c,j=b.z-c,f<d.xMin||d.xMax<=h||g<d.yMin||d.yMax<=l||i<d.zMin||d.zMax<=j||(h<d.xMid&&(l<d.yMid&&(j<d.zMid&&e.push(d.bot_sw),d.zMid<=i&&e.push(d.bot_nw)),d.yMid<=g&&(j<d.zMid&&e.push(d.top_sw),d.zMid<=i&&e.push(d.top_nw))),
d.xMid<=f&&(l<d.yMid&&(j<d.zMid&&e.push(d.bot_se),d.zMid<=i&&e.push(d.bot_ne)),d.yMid<=g&&(j<d.zMid&&e.push(d.top_se),d.zMid<=i&&e.push(d.top_ne))))))}
function add(b){for(var c=[],a=this;a!=void 0||c.length>0;)if(a==void 0&&(b=c.shift(),a=c.shift()),b.x<a.xMin||a.xMax<=b.x||b.y<a.yMin||a.yMax<=b.y||b.z<a.zMin||a.zMax<=b.z)a=a.parent;else if(a.is_empty()||a.has_value()&&b.x==a.value.x&&b.y==a.value.y&&b.z==a.value.z)a.value=b,a=void 0;else{if(a.has_value())a.top_nw=new Octtree(a.xMin,a.xMid,a.yMid,a.yMax,a.zMid,a.zMax,a),a.top_ne=new Octtree(a.xMid,a.xMax,a.yMid,a.yMax,a.zMid,a.zMax,a),a.top_se=new Octtree(a.xMid,a.xMax,a.yMid,a.yMax,a.zMin,a.zMid,
a),a.top_sw=new Octtree(a.xMin,a.xMid,a.yMid,a.yMax,a.zMin,a.zMid,a),a.bot_nw=new Octtree(a.xMin,a.xMid,a.yMin,a.yMid,a.zMid,a.zMax,a),a.bot_ne=new Octtree(a.xMid,a.xMax,a.yMin,a.yMid,a.zMid,a.zMax,a),a.bot_se=new Octtree(a.xMid,a.xMax,a.yMin,a.yMid,a.zMin,a.zMid,a),a.bot_sw=new Octtree(a.xMin,a.xMid,a.yMin,a.yMid,a.zMin,a.zMid,a),c.push(a.value),c.push(a),a.value=void 0;a=b.x<a.xMid?b.y<a.yMid?b.z<a.zMid?a.bot_sw:a.bot_nw:b.z<a.zMid?a.top_sw:a.top_nw:b.y<a.yMid?b.z<a.zMid?a.bot_se:a.bot_ne:b.z<a.zMid?
a.top_se:a.top_ne}}function del(b){return del_inner(this,[b])}function del_inner(b,c){for(var a=0;a<c.length;++a)tree1=del_inner1(b,c),void 0!=tree1&&(b=tree1);return b}
function del_inner1(b,c){for(var a=!1;void 0!=b;)if(b.has_value()){if(c.x==b.value.x&&c.y==b.value.y&&c.z==b.value.z)b.value=void 0,a=!0;break}else if(b.is_empty())break;else b=c.x<b.xMin||b.xMax<=c.x||c.y<b.yMin||b.yMax<=c.y||c.z<b.zMin||b.zMax<=c.z?b.parent:c.x<b.xMid?c.y<b.yMid?c.z<b.zMid?b.bot_sw:b.bot_nw:c.z<b.zMid?b.top_sw:b.top_nw:c.y<b.yMid?c.z<b.zMid?b.bot_se:b.bot_ne:c.z<b.zMid?b.top_se:b.top_ne;if(a)for(a=0;void 0!=b.parent&&1>=a;){b=b.parent;a=0;if(b.top_nw.has_value())a+=1,c=b.top_nw.value;
if(b.top_ne.has_value())a+=1,c=b.top_ne.value;if(b.top_sw.has_value())a+=1,c=b.top_sw.value;if(b.top_se.has_value())a+=1,c=b.top_se.value;if(b.bot_nw.has_value())a+=1,c=b.bot_nw.value;if(b.bot_ne.has_value())a+=1,c=b.bot_ne.value;if(b.bot_sw.has_value())a+=1,c=b.bot_sw.value;if(b.bot_se.has_value())a+=1,c=b.bot_se.value;if(a==1)b.top_ne.parent=void 0,b.top_nw.parent=void 0,b.top_se.parent=void 0,b.top_sw.parent=void 0,b.bot_ne.parent=void 0,b.bot_nw.parent=void 0,b.bot_se.parent=void 0,b.bot_sw.parent=
void 0,b.top_ne=void 0,b.top_nw=void 0,b.top_se=void 0,b.top_sw=void 0,b.bot_ne=void 0,b.bot_nw=void 0,b.bot_se=void 0,b.bot_sw=void 0,b.value=c}return b}function has_value(){return this.value!=void 0}function is_empty(){return this.value==void 0&&this.top_nw==void 0}
function update(){for(var b=this,c=[],a=void 0;void 0!=b;){if(b==this||b.parent!=void 0)if(b.has_value()){if(a=b.value,a.x=a.next_x,a.y=a.next_y,a.z=a.next_z,a.x<b.xMin||b.xMax<=a.x||a.y<b.yMin||b.yMax<=a.y||a.z<b.zMin||b.zMax<=a.z)b=b.del(a),b.add(a)}else b.is_empty()||(c.push(b.top_nw),c.push(b.top_ne),c.push(b.top_sw),c.push(b.top_se),c.push(b.bot_nw),c.push(b.bot_ne),c.push(b.bot_sw),c.push(b.bot_se));b=c.shift()}};